#!/usr/bin/python
# -*- coding: utf-8 -*-

# Fetch and display a RIS entry for a particular IP

config_file = "/mnt/data/ISFATES-DFHI/Masterarbeit/repos/WhoisClient/etc/whois_client.conf"

def usage():
    print "./get_ris IP"
    exit (1)

import sys

if len(sys.argv) < 2:
    usage()

import ConfigParser
import os
config = ConfigParser.RawConfigParser()
config.read(config_file)

sys.path.append(os.path.join(config.get('global','root'),config.get('global','libraries')))

from whois_client import WhoisClient


whois = WhoisClient()

whois.ris_queries(sys.argv[1])


print("Origin:\t\t%s" % whois.parsed_responses[0].route)
print("ASN:\t\t%s" % whois.parsed_responses[0].origin)
print("Description:\t%s" % whois.parsed_responses[0].description)